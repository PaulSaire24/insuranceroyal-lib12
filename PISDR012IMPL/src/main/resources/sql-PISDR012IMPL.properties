PISD.SELECT_INSURANCE_PRODUCT=conPISD;SELECT INSURANCE_RISK_BUSINESS_ID, INSURANCE_PRODUCT_ID, INSURANCE_PRODUCT_DESC FROM PISD.T_PISD_INSURANCE_PRODUCT WHERE INSURANCE_PRODUCT_TYPE = :INSURANCE_PRODUCT_TYPE
PISD.SELECT_INSURANCE_BUSINESS=conPISD;SELECT INSURANCE_BUSINESS_NAME FROM PISD.T_PISD_INSURANCE_BUSINESS WHERE INSURANCE_RISK_BUSINESS_ID = :INSURANCE_RISK_BUSINESS_ID
PISD.SELECT_INSRNC_PRD_MODALITY=conPISD;SELECT INSURANCE_COMPANY_MODALITY_ID, INSURANCE_MODALITY_NAME, INSURANCE_MODALITY_TYPE, SUGGESTED_MODALITY_IND_TYPE FROM PISD.T_PISD_INSRNC_PRD_MODALITY WHERE INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND INSURANCE_MODALITY_TYPE IN (:INSURANCE_MODALITY_TYPE)
PISD.SELECT_CONSIDERATIONS=conPISD;SELECT mc.INSURANCE_MODALITY_TYPE, mc.CNSD_PUBLICATION_ORDER_NUMBER, c.INSURANCE_CONSIDERATION_DESC, c.INSURANCE_CONSIDERATION_TYPE, c.INSRC_CNSD_DATA_VALUE_TYPE, c.INSURANCE_CONSIDERATION_AMOUNT, c.CURRENCY_ID, c.INSURANCE_CONSIDERATION_PER FROM PISD.T_PISD_MODALITY_INSRNC_CNSD mc, PISD.T_PISD_INSRNC_CONSIDERATION c WHERE mc.INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND mc.INSURANCE_MODALITY_TYPE IN (:INSURANCE_MODALITY_TYPE) AND c.INSURANCE_CONSIDERATION_TYPE IN ('CO', 'BE', 'EX', 'DE') AND mc.INSURANCE_CONSIDERATION_ID = c.INSURANCE_CONSIDERATION_ID AND mc.REGISTRY_SITUATION_TYPE = '01' AND c.REGISTRY_SITUATION_TYPE = '01' AND mc.CONSIDERATION_START_DATE <= sysdate AND mc.CONSIDERATION_END_DATE >= sysdate
PISD.SELECT_INSURANCE_SIMULATION_ID=conPISD;SELECT PISD.Q_PISD_SIMULATION_ID0.NEXTVAL FROM DUAL
PISD.INSERT_INSURANCE_SIMULATION=conPISD;INSERT INTO PISD.T_PISD_INSURANCE_SIMULATION (INSURANCE_SIMULATION_ID, INSRNC_COMPANY_SIMULATION_ID, CUSTOMER_ID, CUSTOMER_SIMULATION_DATE, CUST_SIMULATION_EXPIRED_DATE, BANK_FACTOR_TYPE, BANK_FACTOR_AMOUNT, BANK_FACTOR_PER, REGISTRY_SITUATION_TYPE, SOURCE_BRANCH_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_SIMULATION_ID, :INSRNC_COMPANY_SIMULATION_ID, :CUSTOMER_ID, TO_DATE(:CUSTOMER_SIMULATION_DATE, 'DD/MM/YYYY'), TO_DATE(:CUST_SIMULATION_EXPIRED_DATE, 'DD/MM/YYYY'), :BANK_FACTOR_TYPE, :BANK_FACTOR_AMOUNT, :BANK_FACTOR_PER, '01', :SOURCE_BRANCH_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_INSRNC_SIMLT_PRD=conPISD;INSERT INTO PISD.T_PISD_INSRNC_SIMLT_PRD (INSURANCE_SIMULATION_ID, INSURANCE_PRODUCT_ID, CAMPAIGN_FACTOR_TYPE, CAMPAIGN_OFFER_1_AMOUNT, CAMPAIGN_FACTOR_PER, SALE_CHANNEL_ID, REGISTRY_SITUATION_TYPE, SOURCE_BRANCH_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_SIMULATION_ID, :INSURANCE_PRODUCT_ID, :CAMPAIGN_FACTOR_TYPE, :CAMPAIGN_OFFER_1_AMOUNT, :CAMPAIGN_FACTOR_PER, :SALE_CHANNEL_ID, '01', :SOURCE_BRANCH_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_INSRNC_SIMLT_VEHICLE=conPISD;INSERT INTO PISD.T_PISD_INSRNC_SIMLT_VEHICLE (INSURANCE_SIMULATION_ID, INSURANCE_PRODUCT_ID, VEHICLE_BRAND_ID, VEHICLE_BRAND_NAME, VEHICLE_MODEL_ID, VEHICLE_MODEL_NAME, VEHICLE_YEAR_ID, COMMERCIAL_VEHICLE_AMOUNT, CURRENCY_ID, NEW_VEHICLE_IND_TYPE, VEHICLE_CIRCULATION_SCOPE_TYPE, VEH_CHANGE_RUDDER_IND_TYPE, VEHICLE_GAS_CONVERSION_TYPE, VEHICLE_USE_TYPE, VEHICLE_USAGE_DESC, VEHICLE_LICENSE_ID, REGISTRY_SITUATION_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_SIMULATION_ID, :INSURANCE_PRODUCT_ID, :VEHICLE_BRAND_ID, :VEHICLE_BRAND_NAME, :VEHICLE_MODEL_ID, :VEHICLE_MODEL_NAME, :VEHICLE_YEAR_ID, :COMMERCIAL_VEHICLE_AMOUNT, :CURRENCY_ID, :NEW_VEHICLE_IND_TYPE, :VEHICLE_CIRCULATION_SCOPE_TYPE, :VEH_CHANGE_RUDDER_IND_TYPE, :VEHICLE_GAS_CONVERSION_TYPE, :VEHICLE_USE_TYPE, :VEHICLE_USAGE_DESC, :VEHICLE_LICENSE_ID, '01', :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.SELECT_INSURANCE_QUOTATION=conPISD;SELECT NVL(p.INSURANCE_PRODUCT_TYPE, '-') AS PRODUCT_TYPE, NVL(p.INSURANCE_PRODUCT_DESC, '-') AS PRODUCT_DESC, q.QUOTE_DATE AS OPERATION_DATE, q.QUOTA_HMS_DATE AS OPERATION_HMS_DATE, qmod.INSURANCE_MODALITY_TYPE AS PLAN_ID, NVL(qmod.POLICY_PAYMENT_FREQUENCY_TYPE, '-') AS PLAN_PERIOD_ID, NVL(qmod.POLICY_QUOTA_STATUS_TYPE, '-') AS STATUS_ID, NVL(pmod.INSURANCE_MODALITY_NAME, '-') AS PLAN_NAME, NVL(pmod.SUGGESTED_MODALITY_IND_TYPE, '-') AS PLAN_SUGGESTED, NVL(pp.PAYMENT_FREQUENCY_NAME, '-') AS PERIOD_NAME, qmod.PREMIUM_AMOUNT AS AMOUNT, qmod.PREMIUM_CURRENCY_ID AS CURRENCY FROM PISD.T_PISD_INSRNC_QUOTATION_MOD qmod LEFT JOIN PISD.T_PISD_INSURANCE_QUOTATION q ON q.POLICY_QUOTA_INTERNAL_ID = qmod.POLICY_QUOTA_INTERNAL_ID LEFT JOIN PISD.T_PISD_INSRNC_PRD_MODALITY pmod ON pmod.INSURANCE_PRODUCT_ID = qmod.INSURANCE_PRODUCT_ID AND pmod.INSURANCE_MODALITY_TYPE = qmod.INSURANCE_MODALITY_TYPE LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT p ON p.INSURANCE_PRODUCT_ID = qmod.INSURANCE_PRODUCT_ID LEFT JOIN PISD.T_PISD_INSRNC_PAYMENT_PERIOD pp ON pp.POLICY_PAYMENT_FREQUENCY_TYPE = qmod.POLICY_PAYMENT_FREQUENCY_TYPE WHERE q.POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.SELECT_INSURANCE_SIMULATION_BY_QUOTATIONID=conPISD;SELECT INSURANCE_SIMULATION_ID, CUST_SIMULATION_EXPIRED_DATE FROM PISD.T_PISD_INSURANCE_SIMULATION WHERE INSRNC_COMPANY_SIMULATION_ID = :INSRNC_COMPANY_SIMULATION_ID
PISD.INSERT_INSURANCE_QUOTATION=conPISD;INSERT INTO PISD.T_PISD_INSURANCE_QUOTATION (POLICY_QUOTA_INTERNAL_ID, INSURANCE_SIMULATION_ID, INSURANCE_COMPANY_QUOTA_ID, QUOTE_DATE, QUOTA_HMS_DATE, POLICY_QUOTA_END_VALIDITY_DATE, CUSTOMER_ID, POLICY_QUOTA_STATUS_TYPE, LAST_CHANGE_BRANCH_ID, SOURCE_BRANCH_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:POLICY_QUOTA_INTERNAL_ID, :INSURANCE_SIMULATION_ID, :INSURANCE_COMPANY_QUOTA_ID, TO_DATE(:QUOTE_DATE, 'DD/MM/YYYY'), SYSTIMESTAMP, :POLICY_QUOTA_END_VALIDITY_DATE, :CUSTOMER_ID, 'COT', :LAST_CHANGE_BRANCH_ID, :SOURCE_BRANCH_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_INSURANCE_QUOTATION_MOD=conPISD;INSERT INTO PISD.T_PISD_INSRNC_QUOTATION_MOD (POLICY_QUOTA_INTERNAL_ID, INSURANCE_PRODUCT_ID, INSURANCE_MODALITY_TYPE, SALE_CHANNEL_ID, PAYMENT_TERM_NUMBER, POLICY_PAYMENT_FREQUENCY_TYPE, FINANCING_START_DATE, FINANCING_END_DATE, PREMIUM_AMOUNT, PREMIUM_CURRENCY_ID, SAVED_QUOTATION_IND_TYPE, LAST_CHANGE_BRANCH_ID, SOURCE_BRANCH_ID, POLICY_QUOTA_STATUS_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:POLICY_QUOTA_INTERNAL_ID, :INSURANCE_PRODUCT_ID, :INSURANCE_MODALITY_TYPE, :SALE_CHANNEL_ID, :PAYMENT_TERM_NUMBER, :POLICY_PAYMENT_FREQUENCY_TYPE, TO_DATE(:FINANCING_START_DATE, 'DD/MM/YYYY'), TO_DATE(:FINANCING_END_DATE, 'DD/MM/YYYY'), :PREMIUM_AMOUNT, :PREMIUM_CURRENCY_ID, :SAVED_QUOTATION_IND_TYPE, :LAST_CHANGE_BRANCH_ID, :SOURCE_BRANCH_ID, 'COT', :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_INSURANCE_QUOTATION_VEH=conPISD;INSERT INTO PISD.T_PISD_INSRNC_QUOTATION_VEH (POLICY_QUOTA_INTERNAL_ID, INSURANCE_PRODUCT_ID, INSURANCE_MODALITY_TYPE, REQUIRED_INSPECTION_IND_TYPE, GPS_IND_TYPE, CHASSIS_ID, VEHICLE_ENGINE_ID, VEHICLE_SEAT_NUMBER, POLICY_QUOTA_STATUS_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:POLICY_QUOTA_INTERNAL_ID, :INSURANCE_PRODUCT_ID, :INSURANCE_MODALITY_TYPE, :REQUIRED_INSPECTION_IND_TYPE, :GPS_IND_TYPE, :CHASSIS_ID, :VEHICLE_ENGINE_ID, :VEHICLE_SEAT_NUMBER, 'COT', :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.SELECT_INSURANCE_COMPANY=conPISD;SELECT INSURANCE_COMPANY_DESC FROM PISD.T_PISD_INSURANCE_COMPANY WHERE INSURANCE_COMPANY_ID = :INSURANCE_COMPANY_ID
