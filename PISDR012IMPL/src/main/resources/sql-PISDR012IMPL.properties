PISD.GET_PRODUCT_INFORMATION=conPISD;SELECT b.INSURANCE_BUSINESS_NAME, p.INSURANCE_PRODUCT_ID, p.INSURANCE_PRODUCT_DESC FROM PISD.T_PISD_INSURANCE_PRODUCT p INNER JOIN PISD.T_PISD_INSURANCE_BUSINESS b ON p.INSURANCE_RISK_BUSINESS_ID = b.INSURANCE_RISK_BUSINESS_ID WHERE p.INSURANCE_PRODUCT_TYPE = :INSURANCE_PRODUCT_TYPE
PISD.GET_PRODUCT_MODALITIES_INFORMATION=conPISD; SELECT  pm.INSURANCE_COMPANY_MODALITY_ID,  pm.INSURANCE_MODALITY_NAME,  pm.INSURANCE_MODALITY_TYPE,  pm.SUGGESTED_MODALITY_IND_TYPE,  ms.PUBLICATION_ORDER_NUMBER, pm.OPERATION_GLOSSARY_DESC FROM PISD.T_PISD_INSRNC_PRD_MODALITY  pm LEFT JOIN PISD.T_PISD_INSURANCE_MOD_SCHAN ms ON pm.INSURANCE_PRODUCT_ID = ms.INSURANCE_PRODUCT_ID  AND pm.INSURANCE_MODALITY_TYPE = ms.INSURANCE_MODALITY_TYPE WHERE pm.INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND pm.INSURANCE_MODALITY_TYPE IN (:INSURANCE_MODALITY_TYPE) AND ms.SALE_CHANNEL_ID = :SALE_CHANNEL_ID  ORDER BY ms.PUBLICATION_ORDER_NUMBER
PISD.GET_PRODUCT_MODALITY_SELECTED=conPISD;SELECT pm.INSURANCE_COMPANY_MODALITY_ID, pm.INSURANCE_MODALITY_NAME, pm.SUGGESTED_MODALITY_IND_TYPE, p.INSURANCE_PRODUCT_ID, p.INSURANCE_PRODUCT_DESC, c.INSURANCE_COMPANY_DESC FROM PISD.T_PISD_INSRNC_PRD_MODALITY pm INNER JOIN PISD.T_PISD_INSURANCE_PRODUCT P ON pm.INSURANCE_PRODUCT_ID = p.INSURANCE_PRODUCT_ID INNER JOIN PISD.T_PISD_INSURANCE_COMPANY c ON pm.INSURANCE_COMPANY_ID = c.INSURANCE_COMPANY_ID WHERE pm.INSURANCE_PRODUCT_ID = 1 and pm.INSURANCE_MODALITY_TYPE = :INSURANCE_MODALITY_TYPE
PISD.SELECT_INSRNC_PRD_MODALITY_BY_COMPANY_MODALITY_ID=conPISD;SELECT pm.INSURANCE_COMPANY_MODALITY_ID, pm.INSURANCE_MODALITY_NAME, pm.INSURANCE_MODALITY_TYPE, pm.SUGGESTED_MODALITY_IND_TYPE, ic.INSURANCE_COMPANY_ID, ic.INSURANCE_COMPANY_DESC FROM PISD.T_PISD_INSRNC_PRD_MODALITY pm LEFT JOIN PISD.T_PISD_INSURANCE_COMPANY ic ON pm.INSURANCE_COMPANY_ID = ic.INSURANCE_COMPANY_ID WHERE pm.INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND pm.INSURANCE_COMPANY_MODALITY_ID IN (:INSURANCE_COMPANY_MODALITY_ID)
PISD.SELECT_CONSIDERATIONS=conPISD;SELECT mc.INSURANCE_MODALITY_TYPE, mc.MAIN_CONSIDERATION_IND_TYPE, mc.CNSD_PUBLICATION_ORDER_NUMBER, c.INSURANCE_CONSIDERATION_DESC, c.INSURANCE_CONSIDERATION_TYPE, c.INSRC_CNSD_DATA_VALUE_TYPE, c.INSURANCE_CONSIDERATION_AMOUNT, c.CURRENCY_ID, c.INSURANCE_CONSIDERATION_PER FROM PISD.T_PISD_MODALITY_INSRNC_CNSD mc, PISD.T_PISD_INSRNC_CONSIDERATION c WHERE mc.INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND mc.INSURANCE_MODALITY_TYPE IN (:INSURANCE_MODALITY_TYPE) AND mc.INSURANCE_CONSIDERATION_ID = c.INSURANCE_CONSIDERATION_ID AND mc.REGISTRY_SITUATION_TYPE = '01' AND c.REGISTRY_SITUATION_TYPE = '01' AND mc.CONSIDERATION_START_DATE <= sysdate AND mc.CONSIDERATION_END_DATE >= sysdate ORDER BY c.INSURANCE_CONSIDERATION_TYPE, mc.CNSD_PUBLICATION_ORDER_NUMBER
PISD.SELECT_INSURANCE_SIMULATION_ID=conPISD;SELECT PISD.Q_PISD_SIMULATION_ID0.NEXTVAL FROM DUAL
PISD.INSERT_INSURANCE_SIMULATION=conPISD;INSERT INTO PISD.T_PISD_INSURANCE_SIMULATION (INSURANCE_SIMULATION_ID, INSRNC_COMPANY_SIMULATION_ID, CUSTOMER_ID, CUSTOMER_SIMULATION_DATE, CUST_SIMULATION_EXPIRED_DATE, BANK_FACTOR_TYPE, BANK_FACTOR_AMOUNT, BANK_FACTOR_PER, REGISTRY_SITUATION_TYPE, SOURCE_BRANCH_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE, PERSONAL_DOC_TYPE, PARTICIPANT_PERSONAL_ID, INSURED_CUSTOMER_NAME, CLIENT_LAST_NAME) VALUES (:INSURANCE_SIMULATION_ID, :INSRNC_COMPANY_SIMULATION_ID, :CUSTOMER_ID, TO_DATE(:CUSTOMER_SIMULATION_DATE, 'DD/MM/YYYY'), TO_DATE(:CUST_SIMULATION_EXPIRED_DATE, 'DD/MM/YYYY'), :BANK_FACTOR_TYPE, :BANK_FACTOR_AMOUNT, :BANK_FACTOR_PER, '01', :SOURCE_BRANCH_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP, :PERSONAL_DOC_TYPE, :PARTICIPANT_PERSONAL_ID, :INSURED_CUSTOMER_NAME, :CLIENT_LAST_NAME)
PISD.INSERT_INSRNC_SIMLT_PRD=conPISD;INSERT INTO PISD.T_PISD_INSRNC_SIMLT_PRD (INSURANCE_SIMULATION_ID, INSURANCE_PRODUCT_ID, CAMPAIGN_FACTOR_TYPE, CAMPAIGN_OFFER_1_AMOUNT, CAMPAIGN_FACTOR_PER, SALE_CHANNEL_ID, REGISTRY_SITUATION_TYPE, SOURCE_BRANCH_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_SIMULATION_ID, :INSURANCE_PRODUCT_ID, :CAMPAIGN_FACTOR_TYPE, :CAMPAIGN_OFFER_1_AMOUNT, :CAMPAIGN_FACTOR_PER, :SALE_CHANNEL_ID, '01', :SOURCE_BRANCH_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_INSRNC_SIMLT_VEHICLE=conPISD;INSERT INTO PISD.T_PISD_INSRNC_SIMLT_VEHICLE (INSURANCE_SIMULATION_ID, INSURANCE_PRODUCT_ID, VEHICLE_BRAND_ID, VEHICLE_BRAND_NAME, VEHICLE_MODEL_ID, VEHICLE_MODEL_NAME, VEHICLE_YEAR_ID, COMMERCIAL_VEHICLE_AMOUNT, CURRENCY_ID, NEW_VEHICLE_IND_TYPE, VEHICLE_CIRCULATION_SCOPE_TYPE, VEH_CHANGE_RUDDER_IND_TYPE, VEHICLE_GAS_CONVERSION_TYPE, VEHICLE_USE_TYPE, VEHICLE_USAGE_DESC, VEHICLE_LICENSE_ID, REGISTRY_SITUATION_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_SIMULATION_ID, :INSURANCE_PRODUCT_ID, :VEHICLE_BRAND_ID, :VEHICLE_BRAND_NAME, :VEHICLE_MODEL_ID, :VEHICLE_MODEL_NAME, :VEHICLE_YEAR_ID, :COMMERCIAL_VEHICLE_AMOUNT, :CURRENCY_ID, :NEW_VEHICLE_IND_TYPE, :VEHICLE_CIRCULATION_SCOPE_TYPE, :VEH_CHANGE_RUDDER_IND_TYPE, :VEHICLE_GAS_CONVERSION_TYPE, :VEHICLE_USE_TYPE, :VEHICLE_USAGE_DESC, :VEHICLE_LICENSE_ID, '01', :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.SELECT_INSURANCE_QUOTATION=conPISD;SELECT q.POLICY_QUOTA_INTERNAL_ID AS POLICY_QUOTA_INTERNAL_ID, p.INSURANCE_PRODUCT_TYPE AS INSURANCE_PRODUCT_TYPE, p.INSURANCE_PRODUCT_DESC AS INSURANCE_PRODUCT_DESC, q.QUOTA_HMS_DATE AS QUOTA_HMS_DATE, q.CREATION_USER_ID as CREATION_USER_ID, qmod.CONTACT_EMAIL_DESC as CONTACT_EMAIL_DESC, qmod.CUSTOMER_PHONE_DESC as CUSTOMER_PHONE_DESC, qmod.INSURANCE_MODALITY_TYPE AS INSURANCE_MODALITY_TYPE, qmod.POLICY_PAYMENT_FREQUENCY_TYPE AS POLICY_PAYMENT_FREQUENCY_TYPE, qmod.POLICY_QUOTA_STATUS_TYPE AS POLICY_QUOTA_STATUS_TYPE, pmod.INSURANCE_MODALITY_NAME AS INSURANCE_MODALITY_NAME, pmod.SUGGESTED_MODALITY_IND_TYPE AS SUGGESTED_MODALITY_IND_TYPE, pp.PAYMENT_FREQUENCY_NAME AS PAYMENT_FREQUENCY_NAME, qmod.PREMIUM_AMOUNT AS PREMIUM_AMOUNT, qmod.PREMIUM_CURRENCY_ID AS PREMIUM_CURRENCY_ID, v.VEHICLE_MODEL_ID as VEHICLE_MODEL_ID, v.VEHICLE_MODEL_NAME as VEHICLE_MODEL_NAME, v.VEHICLE_BRAND_ID as VEHICLE_BRAND_ID, v.VEHICLE_BRAND_NAME as VEHICLE_BRAND_NAME, v.VEHICLE_YEAR_ID as VEHICLE_YEAR_ID FROM PISD.T_PISD_INSRNC_QUOTATION_MOD qmod LEFT JOIN PISD.T_PISD_INSURANCE_QUOTATION q ON qmod.POLICY_QUOTA_INTERNAL_ID = q.POLICY_QUOTA_INTERNAL_ID LEFT JOIN PISD.T_PISD_INSRNC_PRD_MODALITY pmod ON qmod.INSURANCE_PRODUCT_ID = pmod.INSURANCE_PRODUCT_ID AND qmod.INSURANCE_MODALITY_TYPE = pmod.INSURANCE_MODALITY_TYPE LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT p ON qmod.INSURANCE_PRODUCT_ID = p.INSURANCE_PRODUCT_ID LEFT JOIN PISD.T_PISD_INSRNC_PAYMENT_PERIOD pp ON qmod.POLICY_PAYMENT_FREQUENCY_TYPE = pp.POLICY_PAYMENT_FREQUENCY_TYPE LEFT JOIN PISD.T_PISD_INSRNC_SIMLT_VEHICLE v ON q.INSURANCE_SIMULATION_ID = v.INSURANCE_SIMULATION_ID WHERE q.INSURANCE_COMPANY_QUOTA_ID = :INSURANCE_COMPANY_QUOTA_ID
PISD.SELECT_INSURANCE_SIMULATION_BY_QUOTATIONID=conPISD;SELECT SIM.INSURANCE_SIMULATION_ID, SIM.CUST_SIMULATION_EXPIRED_DATE, SIM.SOURCE_BRANCH_ID, QUO.POLICY_QUOTA_INTERNAL_ID FROM PISD.T_PISD_INSURANCE_SIMULATION SIM LEFT JOIN PISD.T_PISD_INSURANCE_QUOTATION QUO on SIM.INSURANCE_SIMULATION_ID = QUO.INSURANCE_SIMULATION_ID WHERE SIM.INSRNC_COMPANY_SIMULATION_ID = :INSRNC_COMPANY_SIMULATION_ID
PISD.INSERT_INSURANCE_QUOTATION=conPISD;INSERT INTO PISD.T_PISD_INSURANCE_QUOTATION (POLICY_QUOTA_INTERNAL_ID, INSURANCE_SIMULATION_ID, INSURANCE_COMPANY_QUOTA_ID, QUOTE_DATE, QUOTA_HMS_DATE, POLICY_QUOTA_END_VALIDITY_DATE, CUSTOMER_ID, POLICY_QUOTA_STATUS_TYPE, LAST_CHANGE_BRANCH_ID, SOURCE_BRANCH_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE, PERSONAL_DOC_TYPE, PARTICIPANT_PERSONAL_ID, INSURED_CUSTOMER_NAME, CLIENT_LAST_NAME) VALUES (:POLICY_QUOTA_INTERNAL_ID, :INSURANCE_SIMULATION_ID, :INSURANCE_COMPANY_QUOTA_ID, TO_DATE(:QUOTE_DATE, 'DD/MM/YYYY'), SYSTIMESTAMP, :POLICY_QUOTA_END_VALIDITY_DATE, :CUSTOMER_ID, 'COT', :LAST_CHANGE_BRANCH_ID, :SOURCE_BRANCH_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP, :PERSONAL_DOC_TYPE, :PARTICIPANT_PERSONAL_ID, :INSURED_CUSTOMER_NAME, :CLIENT_LAST_NAME)
PISD.INSERT_INSURANCE_QUOTATION_MOD=conPISD;INSERT INTO PISD.T_PISD_INSRNC_QUOTATION_MOD (POLICY_QUOTA_INTERNAL_ID, INSURANCE_PRODUCT_ID, INSURANCE_MODALITY_TYPE, SALE_CHANNEL_ID, PAYMENT_TERM_NUMBER, POLICY_PAYMENT_FREQUENCY_TYPE, FINANCING_START_DATE, FINANCING_END_DATE, PREMIUM_AMOUNT, PREMIUM_CURRENCY_ID, SAVED_QUOTATION_IND_TYPE, LAST_CHANGE_BRANCH_ID, SOURCE_BRANCH_ID, POLICY_QUOTA_STATUS_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE, CONTACT_EMAIL_DESC, CUSTOMER_PHONE_DESC, DATA_TREATMENT_IND_TYPE, CONTACT_TIME_TYPE) VALUES (:POLICY_QUOTA_INTERNAL_ID, :INSURANCE_PRODUCT_ID, :INSURANCE_MODALITY_TYPE, :SALE_CHANNEL_ID, :PAYMENT_TERM_NUMBER, :POLICY_PAYMENT_FREQUENCY_TYPE, TO_DATE(:FINANCING_START_DATE, 'DD/MM/YYYY'), TO_DATE(:FINANCING_END_DATE, 'DD/MM/YYYY'), :PREMIUM_AMOUNT, :PREMIUM_CURRENCY_ID, :SAVED_QUOTATION_IND_TYPE, :LAST_CHANGE_BRANCH_ID, :SOURCE_BRANCH_ID, 'COT', :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP, :CONTACT_EMAIL_DESC, :CUSTOMER_PHONE_DESC, :DATA_TREATMENT_IND_TYPE, :CONTACT_TIME_TYPE)
PISD.UPDATE_INSURANCE_QUOTATION_MOD=conPISD;UPDATE PISD.T_PISD_INSRNC_QUOTATION_MOD SET PREMIUM_AMOUNT = :PREMIUM_AMOUNT, PREMIUM_CURRENCY_ID = :PREMIUM_CURRENCY_ID, LAST_CHANGE_BRANCH_ID = :LAST_CHANGE_BRANCH_ID, USER_AUDIT_ID = :USER_AUDIT_ID, AUDIT_DATE = SYSTIMESTAMP WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID AND INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND INSURANCE_MODALITY_TYPE = :INSURANCE_MODALITY_TYPE
PISD.UPDATE_INSURANCE_QUOTATION_MOD_AMOUNT=conPISD;UPDATE PISD.T_PISD_INSRNC_QUOTATION_MOD SET PREMIUM_AMOUNT = :PREMIUM_AMOUNT, PREMIUM_CURRENCY_ID = :PREMIUM_CURRENCY_ID, POLICY_PAYMENT_FREQUENCY_TYPE = :POLICY_PAYMENT_FREQUENCY_TYPE, USER_AUDIT_ID = :USER_AUDIT_ID, AUDIT_DATE = SYSTIMESTAMP WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID;
PISD.INSERT_INSURANCE_QUOTATION_VEH=conPISD;INSERT INTO PISD.T_PISD_INSRNC_QUOTATION_VEH (POLICY_QUOTA_INTERNAL_ID, INSURANCE_PRODUCT_ID, INSURANCE_MODALITY_TYPE, REQUIRED_INSPECTION_IND_TYPE, GPS_IND_TYPE, CHASSIS_ID, VEHICLE_ENGINE_ID, VEHICLE_SEAT_NUMBER, POLICY_QUOTA_STATUS_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:POLICY_QUOTA_INTERNAL_ID, :INSURANCE_PRODUCT_ID, :INSURANCE_MODALITY_TYPE, :REQUIRED_INSPECTION_IND_TYPE, :GPS_IND_TYPE, :CHASSIS_ID, :VEHICLE_ENGINE_ID, :VEHICLE_SEAT_NUMBER, 'COT', :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.UPDATE_INSURANCE_QUOTATION_VEH=conPISD;UPDATE PISD.T_PISD_INSRNC_QUOTATION_VEH SET CHASSIS_ID = :CHASSIS_ID, VEHICLE_ENGINE_ID = :VEHICLE_ENGINE_ID , VEHICLE_SEAT_NUMBER = :VEHICLE_SEAT_NUMBER , USER_AUDIT_ID = :USER_AUDIT_ID, AUDIT_DATE = SYSTIMESTAMP WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.SELECT_INSURANCE_QUOTATION_REGISTER=conPISD;SELECT q.INSURANCE_COMPANY_QUOTA_ID as INSURANCE_COMPANY_QUOTA_ID, q.CUSTOMER_ID as CUSTOMER_ID, qmod.CONTACT_EMAIL_DESC as CONTACT_EMAIL_DESC, qmod.CUSTOMER_PHONE_DESC as CUSTOMER_PHONE_DESC, q.PARTICIPANT_PERSONAL_ID as PARTICIPANT_PERSONAL_ID, ip.INSURANCE_PRODUCT_TYPE as INSURANCE_PRODUCT_TYPE, qmod.INSURANCE_MODALITY_TYPE, ip.PRODUCT_SHORT_DESC, bs.INSURANCE_BUSINESS_NAME FROM PISD.T_PISD_INSURANCE_QUOTATION q LEFT JOIN PISD.T_PISD_INSRNC_QUOTATION_MOD qmod ON q.POLICY_QUOTA_INTERNAL_ID = qmod.POLICY_QUOTA_INTERNAL_ID LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT ip ON qmod.INSURANCE_PRODUCT_ID = ip.INSURANCE_PRODUCT_ID LEFT JOIN pisd.T_PISD_INSURANCE_BUSINESS bs ON ip.INSURANCE_RISK_BUSINESS_ID = bs.INSURANCE_RISK_BUSINESS_ID WHERE q.POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID   
PISD.QUERY_FOR_GET_QUOTATION_SERVICE=conPISD;SELECT q.INSURANCE_COMPANY_QUOTA_ID AS INSURANCE_COMPANY_QUOTA_ID, q.CUSTOMER_ID AS CUSTOMER_ID, q.CREATION_DATE as CREATION_DATE, q.POLICY_QUOTA_STATUS_TYPE AS POLICY_QUOTA_STATUS_TYPE, q.CREATION_USER_ID as CREATION_USER_ID, q.SOURCE_BRANCH_ID AS SOURCE_BRANCH_ID, qv.INSURANCE_PRODUCT_ID AS INSURANCE_PRODUCT_ID, qv.REQUIRED_INSPECTION_IND_TYPE AS REQUIRED_INSPECTION_IND_TYPE, qv.GPS_IND_TYPE AS GPS_IND_TYPE, qv.CHASSIS_ID AS CHASSIS_ID, qv.VEHICLE_ENGINE_ID AS VEHICLE_ENGINE_ID, qv.VEHICLE_SEAT_NUMBER AS VEHICLE_SEAT_NUMBER, sv.VEHICLE_USE_TYPE as VEHICLE_USE_TYPE, sv.VEHICLE_USAGE_DESC as VEHICLE_USAGE_DESC, sv.VEHICLE_BRAND_ID AS VEHICLE_BRAND_ID, sv.VEHICLE_BRAND_NAME AS VEHICLE_BRAND_NAME, sv.VEHICLE_MODEL_ID AS VEHICLE_MODEL_ID, sv.VEHICLE_MODEL_NAME AS VEHICLE_MODEL_NAME, sv.VEHICLE_YEAR_ID AS VEHICLE_YEAR_ID, sv.COMMERCIAL_VEHICLE_AMOUNT AS COMMERCIAL_VEHICLE_AMOUNT, sv.CURRENCY_ID AS CURRENCY_ID, sv.VEHICLE_CIRCULATION_SCOPE_TYPE AS VEHICLE_CIRCULATION_SCOPE_TYPE, sv.VEHICLE_GAS_CONVERSION_TYPE AS VEHICLE_GAS_CONVERSION_TYPE, sv.VEHICLE_LICENSE_ID AS VEHICLE_LICENSE_ID, p.INSURANCE_PRODUCT_TYPE AS INSURANCE_PRODUCT_TYPE, p.INSURANCE_PRODUCT_DESC AS INSURANCE_PRODUCT_DESC, qmod.CONTACT_EMAIL_DESC as CONTACT_EMAIL_DESC, qmod.CUSTOMER_PHONE_DESC as CUSTOMER_PHONE_DESC, qmod.SAVED_QUOTATION_IND_TYPE as SAVED_QUOTATION_IND_TYPE FROM PISD.T_PISD_INSURANCE_QUOTATION q LEFT JOIN PISD.T_PISD_INSRNC_QUOTATION_MOD qmod ON q.POLICY_QUOTA_INTERNAL_ID = qmod.POLICY_QUOTA_INTERNAL_ID LEFT JOIN PISD.T_PISD_INSRNC_QUOTATION_VEH qv ON q.POLICY_QUOTA_INTERNAL_ID = qv.POLICY_QUOTA_INTERNAL_ID LEFT JOIN PISD.T_PISD_INSRNC_SIMLT_VEHICLE sv ON q.INSURANCE_SIMULATION_ID = sv.INSURANCE_SIMULATION_ID LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT p ON sv.INSURANCE_PRODUCT_ID = p.INSURANCE_PRODUCT_ID WHERE q.POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.UPDATE_INSURANCE_QUOTATION=conPISD; UPDATE PISD.T_PISD_INSURANCE_QUOTATION  SET LAST_CHANGE_BRANCH_ID = :LAST_CHANGE_BRANCH_ID , USER_AUDIT_ID = :USER_AUDIT_ID, AUDIT_DATE = SYSTIMESTAMP WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.UPDATE_INSRNC_QUOTATION_MOD=conPISD; UPDATE PISD.T_PISD_INSRNC_QUOTATION_MOD  SET LAST_CHANGE_BRANCH_ID = :LAST_CHANGE_BRANCH_ID , USER_AUDIT_ID = :USER_AUDIT_ID, AUDIT_DATE = SYSTIMESTAMP WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.VALIDATE_IF_POLICY_EXISTS=conPISD; SELECT COUNT(POLICY_QUOTA_INTERNAL_ID) AS RESULT_NUMBER FROM PISD.T_PISD_INSURANCE_CONTRACT WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID AND CREATION_DATE >= TRUNC(SYSDATE - 30)
PISD.SELECT_REQUIRED_FIELDS_FOR_INSURANCE_CONTRACT=conPISD; SELECT pmod.OPERATION_GLOSSARY_DESC as OPERATION_GLOSSARY_DESC, qmod.INSURANCE_PRODUCT_ID AS INSURANCE_PRODUCT_ID, qmod.CONTACT_EMAIL_DESC as CONTACT_EMAIL_DESC, qmod.CUSTOMER_PHONE_DESC as CUSTOMER_PHONE_DESC, p.INSURANCE_PRODUCT_DESC AS INSURANCE_PRODUCT_DESC, pmod.INSURANCE_MODALITY_NAME AS INSURANCE_MODALITY_NAME, pmod.CONTRACT_DURATION_TYPE AS CONTRACT_DURATION_TYPE, pmod.CONTRACT_DURATION_NUMBER AS CONTRACT_DURATION_NUMBER, q.INSURANCE_COMPANY_QUOTA_ID AS INSURANCE_COMPANY_QUOTA_ID, q.PARTICIPANT_PERSONAL_ID AS PARTICIPANT_PERSONAL_ID, s.INSRNC_COMPANY_SIMULATION_ID as INSRNC_COMPANY_SIMULATION_ID, sv.VEHICLE_LICENSE_ID as VEHICLE_LICENSE_ID, sv.VEHICLE_BRAND_NAME as VEHICLE_BRAND_NAME, sv.VEHICLE_MODEL_NAME as VEHICLE_MODEL_NAME, sv.VEHICLE_YEAR_ID as VEHICLE_YEAR_ID, sv.VEHICLE_GAS_CONVERSION_TYPE as VEHICLE_GAS_CONVERSION_TYPE, sv.VEHICLE_CIRCULATION_SCOPE_TYPE as VEHICLE_CIRCULATION_SCOPE_TYPE, sv.COMMERCIAL_VEHICLE_AMOUNT as COMMERCIAL_VEHICLE_AMOUNT, p.PRODUCT_SHORT_DESC as INSURANCE_BUSINESS_NAME, qmod.POLICY_PAYMENT_FREQUENCY_TYPE, qmod.PREMIUM_AMOUNT, qmod.PREMIUM_CURRENCY_ID FROM PISD.T_PISD_INSRNC_QUOTATION_MOD qmod LEFT JOIN PISD.T_PISD_INSRNC_PRD_MODALITY pmod ON (qmod.INSURANCE_MODALITY_TYPE = pmod.INSURANCE_MODALITY_TYPE AND qmod.INSURANCE_PRODUCT_ID = pmod.INSURANCE_PRODUCT_ID) LEFT JOIN PISD.T_PISD_INSURANCE_QUOTATION q ON qmod.POLICY_QUOTA_INTERNAL_ID = q.POLICY_QUOTA_INTERNAL_ID LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT p ON qmod.INSURANCE_PRODUCT_ID = p.INSURANCE_PRODUCT_ID LEFT JOIN PISD.T_PISD_INSURANCE_SIMULATION s ON q.INSURANCE_SIMULATION_ID = s.INSURANCE_SIMULATION_ID LEFT JOIN PISD.T_PISD_INSRNC_SIMLT_VEHICLE sv ON q.INSURANCE_SIMULATION_ID = sv.INSURANCE_SIMULATION_ID WHERE qmod.POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID AND qmod.CREATION_DATE >= TRUNC(SYSDATE - 30)
PISD.SELECT_PAYMENT_PERIOD=conPISD; SELECT PAYMENT_FREQUENCY_ID, PAYMENT_FREQUENCY_NAME FROM PISD.T_PISD_INSRNC_PAYMENT_PERIOD WHERE POLICY_PAYMENT_FREQUENCY_TYPE = :POLICY_PAYMENT_FREQUENCY_TYPE
PISD.INSERT_CONTRACT=conPISD; INSERT INTO PISD.T_PISD_INSURANCE_CONTRACT (INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID, CONTRACT_FIRST_VERFN_DIGIT_ID, CONTRACT_SECOND_VERFN_DIGIT_ID, POLICY_QUOTA_INTERNAL_ID, INSURANCE_PRODUCT_ID, INSURANCE_MODALITY_TYPE, INSURANCE_COMPANY_ID, INSURANCE_MANAGER_ID, INSURANCE_PROMOTER_ID, CONTRACT_MANAGER_BRANCH_ID, CONTRACT_INCEPTION_DATE, INSURANCE_CONTRACT_START_DATE, INSRNC_VALIDITY_MONTHS_NUMBER, CUSTOMER_ID, DOMICILE_CONTRACT_ID, CARD_ISSUING_MARK_TYPE, ISSUED_RECEIPT_NUMBER, PAYMENT_FREQUENCY_ID, PREMIUM_AMOUNT, SETTLE_PENDING_PREMIUM_AMOUNT, CURRENCY_ID, INSTALLMENT_PERIOD_FINAL_DATE, INSURED_AMOUNT, BENEFICIARY_TYPE, RENEWAL_NUMBER, CTRCT_DISPUTE_STATUS_TYPE, ENDORSEMENT_POLICY_IND_TYPE, INSRNC_CO_CONTRACT_STATUS_TYPE, CONTRACT_STATUS_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE, INSUR_PENDING_DEBT_IND_TYPE, TOTAL_DEBT_AMOUNT, PREV_PEND_BILL_RCPTS_NUMBER, SETTLEMENT_VAR_PREMIUM_AMOUNT, SETTLEMENT_FIX_PREMIUM_AMOUNT, AUTOMATIC_DEBIT_INDICATOR_TYPE, BIOMETRY_TRANSACTION_ID, TELEMARKETING_TRANSACTION_ID, ORIGINAL_PAYMENT_SUBCHANNEL_ID) VALUES (:INSURANCE_CONTRACT_ENTITY_ID, :INSURANCE_CONTRACT_BRANCH_ID, :INSRC_CONTRACT_INT_ACCOUNT_ID, :CONTRACT_FIRST_VERFN_DIGIT_ID, :CONTRACT_SECOND_VERFN_DIGIT_ID, :POLICY_QUOTA_INTERNAL_ID, :INSURANCE_PRODUCT_ID, :INSURANCE_MODALITY_TYPE, :INSURANCE_COMPANY_ID, :INSURANCE_MANAGER_ID, :INSURANCE_PROMOTER_ID, :CONTRACT_MANAGER_BRANCH_ID, TO_DATE(:CONTRACT_INCEPTION_DATE, 'DD/MM/YYYY'), TO_DATE(:INSURANCE_CONTRACT_START_DATE, 'DD/MM/YYYY'), :INSRNC_VALIDITY_MONTHS_NUMBER, :CUSTOMER_ID, :DOMICILE_CONTRACT_ID, :CARD_ISSUING_MARK_TYPE, :ISSUED_RECEIPT_NUMBER, :PAYMENT_FREQUENCY_ID, :PREMIUM_AMOUNT, :SETTLE_PENDING_PREMIUM_AMOUNT, :CURRENCY_ID, TO_DATE(:INSTALLMENT_PERIOD_FINAL_DATE, 'DD/MM/YYYY'), :INSURED_AMOUNT, :BENEFICIARY_TYPE, :RENEWAL_NUMBER, :CTRCT_DISPUTE_STATUS_TYPE, :ENDORSEMENT_POLICY_IND_TYPE, :INSRNC_CO_CONTRACT_STATUS_TYPE, :CONTRACT_STATUS_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP, :INSUR_PENDING_DEBT_IND_TYPE, :TOTAL_DEBT_AMOUNT, :PREV_PEND_BILL_RCPTS_NUMBER, :SETTLEMENT_VAR_PREMIUM_AMOUNT, :SETTLEMENT_FIX_PREMIUM_AMOUNT, :AUTOMATIC_DEBIT_INDICATOR_TYPE, :BIOMETRY_TRANSACTION_ID, :TELEMARKETING_TRANSACTION_ID, :ORIGINAL_PAYMENT_SUBCHANNEL_ID)
PISD.UPDATE_CONTRACT=conPISD; UPDATE PISD.T_PISD_INSURANCE_CONTRACT SET POLICY_ID = :POLICY_ID, INSURANCE_CONTRACT_END_DATE = TO_DATE(:INSURANCE_CONTRACT_END_DATE, 'DD/MM/YYYY'), INSURANCE_POLICY_END_DATE = TO_DATE(:INSURANCE_POLICY_END_DATE, 'DD/MM/YYYY'), LAST_INSTALLMENT_DATE = TO_DATE(:LAST_INSTALLMENT_DATE, 'DD/MM/YYYY'), PERIOD_NEXT_PAYMENT_DATE = TO_DATE(:PERIOD_NEXT_PAYMENT_DATE, 'DD/MM/YYYY'), INSRNC_CO_CONTRACT_STATUS_TYPE = :INSRNC_CO_CONTRACT_STATUS_TYPE, INSURANCE_COMPANY_PRODUCT_ID = :INSURANCE_COMPANY_PRODUCT_ID WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID
PISD.INSERT_CTR_RECEIPTS=conPISD; INSERT INTO PISD.T_PISD_INSURANCE_CTR_RECEIPTS (INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID, POLICY_RECEIPT_ID, INSURANCE_COMPANY_ID, PREMIUM_PAYMENT_RECEIPT_AMOUNT, FIXING_EXCHANGE_RATE_AMOUNT, PREMIUM_CURRENCY_EXCH_AMOUNT, PREMIUM_CHARGE_OPERATION_ID, CURRENCY_ID, RECEIPT_ISSUE_DATE, RECEIPT_START_DATE, RECEIPT_END_DATE, RECEIPT_COLLECTION_DATE, RECEIPT_EXPIRATION_DATE, RECEIPTS_TRANSMISSION_DATE, RECEIPT_COLLECTION_STATUS_TYPE, INSURANCE_COLLECTION_MOVE_ID, PAYMENT_METHOD_TYPE, DEBIT_ACCOUNT_ID, DEBIT_CHANNEL_TYPE, CHARGE_ATTEMPTS_NUMBER, INSRNC_CO_RECEIPT_STATUS_TYPE, RECEIPT_STATUS_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE, MANAGEMENT_BRANCH_ID, VARIABLE_PREMIUM_AMOUNT, FIX_PREMIUM_AMOUNT, SETTLEMENT_VAR_PREMIUM_AMOUNT, SETTLEMENT_FIX_PREMIUM_AMOUNT, LAST_CHANGE_BRANCH_ID, GL_BRANCH_ID) VALUES (:INSURANCE_CONTRACT_ENTITY_ID, :INSURANCE_CONTRACT_BRANCH_ID, :INSRC_CONTRACT_INT_ACCOUNT_ID, :POLICY_RECEIPT_ID, :INSURANCE_COMPANY_ID, :PREMIUM_PAYMENT_RECEIPT_AMOUNT, :FIXING_EXCHANGE_RATE_AMOUNT, :PREMIUM_CURRENCY_EXCH_AMOUNT, :PREMIUM_CHARGE_OPERATION_ID, :CURRENCY_ID, TO_DATE(:RECEIPT_ISSUE_DATE, 'DD/MM/YYYY'), TO_DATE(:RECEIPT_START_DATE, 'DD/MM/YYYY'), TO_DATE(:RECEIPT_END_DATE, 'DD/MM/YYYY'), TO_DATE(:RECEIPT_COLLECTION_DATE, 'DD/MM/YYYY'), TO_DATE(:RECEIPT_EXPIRATION_DATE, 'DD/MM/YYYY'), TO_DATE(:RECEIPTS_TRANSMISSION_DATE, 'DD/MM/YYYY'), :RECEIPT_COLLECTION_STATUS_TYPE, :INSURANCE_COLLECTION_MOVE_ID, :PAYMENT_METHOD_TYPE, :DEBIT_ACCOUNT_ID, :DEBIT_CHANNEL_TYPE, :CHARGE_ATTEMPTS_NUMBER, :INSRNC_CO_RECEIPT_STATUS_TYPE, :RECEIPT_STATUS_TYPE, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP, :MANAGEMENT_BRANCH_ID, :VARIABLE_PREMIUM_AMOUNT, :FIX_PREMIUM_AMOUNT, :SETTLEMENT_VAR_PREMIUM_AMOUNT, :SETTLEMENT_FIX_PREMIUM_AMOUNT, :LAST_CHANGE_BRANCH_ID, :GL_BRANCH_ID)
PISD.UPDATE_EXPIRATION_DATE_RECEIPTS=conPISD; UPDATE PISD.T_PISD_INSURANCE_CTR_RECEIPTS SET RECEIPT_EXPIRATION_DATE = TO_DATE(:RECEIPT_EXPIRATION_DATE, 'DD/MM/YYYY') WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID AND POLICY_RECEIPT_ID = :POLICY_RECEIPT_ID
PISD.INSERT_INSRNC_CONTRACT_MOV=conPISD; INSERT INTO PISD.T_PISD_INSRNC_CONTRACT_MOV (INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID, POLICY_MOVEMENT_NUMBER, GL_ACCOUNT_DATE, GL_BRANCH_ID, MOVEMENT_TYPE, POLICY_MOVEMENT_DATE, ADDITIONAL_DATA_DESC, CONTRACT_STATUS_DATE, CONTRACT_STATUS_ID, MOVEMENT_STATUS_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_CONTRACT_ENTITY_ID, :INSURANCE_CONTRACT_BRANCH_ID, :INSRC_CONTRACT_INT_ACCOUNT_ID, :POLICY_MOVEMENT_NUMBER, TO_DATE(:GL_ACCOUNT_DATE, 'DD/MM/YYYY'), :GL_BRANCH_ID, :MOVEMENT_TYPE, SYSDATE, :ADDITIONAL_DATA_DESC, SYSDATE, :CONTRACT_STATUS_ID, :MOVEMENT_STATUS_TYPE, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.SELECT_INSRNC_ROLE_MODALITY=conPISD; SELECT PARTICIPANT_ROLE_ID FROM PISD.T_PISD_INSRNC_ROLE_MODALITY WHERE INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND INSURANCE_MODALITY_TYPE = :INSURANCE_MODALITY_TYPE
PISD.INSERT_INSRNC_CTR_PARTICIPANT=conPISD; INSERT INTO PISD.T_PISD_INSRNC_CTR_PARTICIPANT (INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID, PARTICIPANT_ROLE_ID, PARTY_ORDER_NUMBER, PERSONAL_DOC_TYPE, PARTICIPANT_PERSONAL_ID, CUSTOMER_ID, CUSTOMER_RELATIONSHIP_TYPE, REGISTRY_SITUATION_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_CONTRACT_ENTITY_ID, :INSURANCE_CONTRACT_BRANCH_ID, :INSRC_CONTRACT_INT_ACCOUNT_ID, :PARTICIPANT_ROLE_ID, :PARTY_ORDER_NUMBER, :PERSONAL_DOC_TYPE, :PARTICIPANT_PERSONAL_ID, :CUSTOMER_ID, :CUSTOMER_RELATIONSHIP_TYPE, :REGISTRY_SITUATION_TYPE, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_CONTRACT_ENDOSERMENT=conPISD; INSERT INTO PISD.T_PISD_ENDORSEMENT_INSRNC_CTR (INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID, DOCUMENT_TYPE_ID, DOCUMENT_ID, ENDORSEMENT_SEQUENCE_NUMBER, ENDORSEMENT_POLICY_ID, ENDORSEMENT_EFF_START_DATE, ENDORSEMENT_EFF_END_DATE, POLICY_ENDORSEMENT_PER, REGISTRY_SITUATION_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_CONTRACT_ENTITY_ID, :INSURANCE_CONTRACT_BRANCH_ID, :INSRC_CONTRACT_INT_ACCOUNT_ID, :DOCUMENT_TYPE_ID,:DOCUMENT_ID, :ENDORSEMENT_SEQUENCE_NUMBER, :ENDORSEMENT_POLICY_ID, TO_DATE(:ENDORSEMENT_EFF_START_DATE, 'DD/MM/YYYY'), TO_DATE(:ENDORSEMENT_EFF_END_DATE, 'DD/MM/YYYY'), :POLICY_ENDORSEMENT_PER, :REGISTRY_SITUATION_TYPE, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.UPDATE_CONTRACT_ENDORSEMENT=conPISD; UPDATE PISD.T_PISD_ENDORSEMENT_INSRNC_CTR SET ENDORSEMENT_POLICY_ID = :ENDORSEMENT_POLICY_ID WHERE INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID
PISD.SELECT_INSURANCE_CONTRACT=conPISD; SELECT POLICY_ID, INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID, CONTRACT_FIRST_VERFN_DIGIT_ID, CONTRACT_SECOND_VERFN_DIGIT_ID FROM PISD.T_PISD_INSURANCE_CONTRACT WHERE POLICY_ID = :POLICY_ID
PISD.GET_INSRC_CONTRACT_STATUS=conPISD; SELECT c.INSRNC_CO_CONTRACT_STATUS_TYPE AS INSRNC_CO_CONTRACT_STATUS_TYPE, p.INSURANCE_PRODUCT_TYPE AS INSURANCE_PRODUCT_TYPE, p.PRODUCT_SHORT_DESC as PRODUCT_SHORT_DESC FROM PISD.T_PISD_INSURANCE_CONTRACT c INNER JOIN PISD.T_PISD_INSURANCE_PRODUCT p ON c.INSURANCE_PRODUCT_ID = p.INSURANCE_PRODUCT_ID WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID
PISD.UPDATE_INSURANCE_CONTRACT_STATUS_ERR=conPISD; UPDATE PISD.T_PISD_INSURANCE_CONTRACT SET INSURANCE_CONTRACT_END_DATE = TO_DATE(:INSURANCE_CONTRACT_END_DATE, 'DD/MM/YYYY'), INSURANCE_POLICY_END_DATE = TO_DATE(:INSURANCE_POLICY_END_DATE, 'DD/MM/YYYY'), LAST_INSTALLMENT_DATE = TO_DATE(:LAST_INSTALLMENT_DATE, 'DD/MM/YYYY'), PERIOD_NEXT_PAYMENT_DATE = TO_DATE(:PERIOD_NEXT_PAYMENT_DATE, 'DD/MM/YYYY'), INSURANCE_COMPANY_PRODUCT_ID = :INSURANCE_COMPANY_PRODUCT_ID, INSRNC_CO_CONTRACT_STATUS_TYPE = :INSRNC_CO_CONTRACT_STATUS_TYPE WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID
PISD.UPDATE_INSURANCE_CONTRACT_STATUS_PEN=conPISD; UPDATE PISD.T_PISD_INSURANCE_CONTRACT SET INSRNC_CO_CONTRACT_STATUS_TYPE = :INSRNC_CO_CONTRACT_STATUS_TYPE WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID
PISD.QUERY_FOR_GET_INSURANCE_COMPANY_QUOTA_ID=conPISD; SELECT ip.INSURANCE_PRODUCT_TYPE AS INSURANCE_PRODUCT_TYPE, ic.POLICY_ID AS POLICY_ID FROM PISD.T_PISD_INSURANCE_CONTRACT ic LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT ip ON ip.INSURANCE_PRODUCT_ID = ic.INSURANCE_PRODUCT_ID WHERE ic.INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND ic.INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND ic.INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID
PISD.UPDATE_CTR_RECEIPTS=conPISD; UPDATE PISD.T_PISD_INSURANCE_CTR_RECEIPTS SET PREMIUM_PAYMENT_RECEIPT_AMOUNT = :PREMIUM_PAYMENT_RECEIPT_AMOUNT, RECEIPT_END_DATE = :RECEIPT_END_DATE, FIX_PREMIUM_AMOUNT = :FIX_PREMIUM_AMOUNT, INSURANCE_COMPANY_RECEIPT_ID = :INSURANCE_COMPANY_RECEIPT_ID, RECEIPT_EXPIRATION_DATE = :RECEIPT_EXPIRATION_DATE, RECEIPT_START_DATE = :RECEIPT_START_DATE WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID AND POLICY_RECEIPT_ID = :POLICY_RECEIPT_ID
PISD.SELECT_INSURANCE_CONTRACT_START_DATE=conPISD; SELECT ic.INSURANCE_CONTRACT_START_DATE AS INSURANCE_CONTRACT_START_DATE, ip.INSURANCE_PRODUCT_TYPE AS INSURANCE_PRODUCT_TYPE FROM PISD.T_PISD_INSURANCE_CONTRACT ic LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT ip ON ic.INSURANCE_PRODUCT_ID = ip.INSURANCE_PRODUCT_ID WHERE ic.INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND ic.INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND ic.INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID
PISD.SELECT_CONTRACT_DOCUMENT_STATUS=conPISD; SELECT CONT_PREVIOUS_SITUATION_TYPE, INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID FROM PISD.T_PISD_INSURANCE_CONTRACT WHERE ROWNUM <= 100
PISD.UPDATE_CONTRACT_DOCUMENT_STATUS=conPISD; UPDATE PISD.T_PISD_INSURANCE_CONTRACT SET CONT_PREVIOUS_SITUATION_TYPE = :CONT_PREVIOUS_SITUATION_TYPE WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID
PISD.SELECT_OFFER=conPISD; SELECT ip.INSURANCE_PRODUCT_TYPE AS INSURANCE_PRODUCT_TYPE, io.PRODUCT_OFFER_ID AS PRODUCT_OFFER_ID, io.OFFER_DESC AS OFFER_DESC, io.FREQUENCY_ID AS FREQUENCY_ID, io.TARIFF_AMOUNT AS TARIFF_AMOUNT, io.TARIFF_CURRENCY_ID AS TARIFF_CURRENCY_ID, io.INSURANCE_COMPANY_ID AS INSURANCE_COMPANY_ID, ip.INSURANCE_PRODUCT_DESC AS INSURANCE_PRODUCT_DESC, ic.INSURANCE_COMPANY_DESC AS INSURANCE_COMPANY_DESC, ipp.PAYMENT_FREQUENCY_NAME AS PAYMENT_FREQUENCY_NAME, ipp.POLICY_PAYMENT_FREQUENCY_TYPE AS POLICY_PAYMENT_FREQUENCY_TYPE, oc.CNSD_PUBLICATION_ORDER_NUMBER AS CNSD_PUBLICATION_ORDER_NUMBER, ico.INSURANCE_CONSIDERATION_TYPE AS INSURANCE_CONSIDERATION_TYPE,ico.INSURANCE_CONSIDERATION_ID AS INSURANCE_CONSIDERATION_ID, ico.INSURANCE_CONSIDERATION_DESC AS INSURANCE_CONSIDERATION_DESC, ico.INSURANCE_CONSIDERATION_PER AS INSURANCE_CONSIDERATION_PER, ico.INSURANCE_CONSIDERATION_AMOUNT AS INSURANCE_CONSIDERATION_AMOUNT, ico.CURRENCY_ID AS CURRENCY_ID, ipm.INSURANCE_COMPANY_CONTRACT_ID AS INSURANCE_COMPANY_CONTRACT_ID, ipm.CONTRACT_DURATION_TYPE AS CONTRACT_DURATION_TYPE, ipm.CONTRACT_DURATION_NUMBER AS CONTRACT_DURATION_NUMBER FROM PISD.T_PISD_INSURANCE_OFFER io LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT ip ON io.INSURANCE_PRODUCT_ID = ip.INSURANCE_PRODUCT_ID LEFT JOIN PISD.T_PISD_INSURANCE_COMPANY ic ON io.INSURANCE_COMPANY_ID = ic.INSURANCE_COMPANY_ID LEFT JOIN PISD.T_PISD_INSRNC_PAYMENT_PERIOD ipp ON io.FREQUENCY_ID = ipp.PAYMENT_FREQUENCY_ID LEFT JOIN PISD.T_PISD_OFFER_CONSIDERATION oc ON io.PRODUCT_OFFER_ID = oc.PRODUCT_OFFER_ID LEFT JOIN PISD.T_PISD_INSRNC_CONSIDERATION ico ON oc.INSURANCE_CONSIDERATION_ID = ico.INSURANCE_CONSIDERATION_ID LEFT JOIN PISD.T_PISD_INSRNC_PRD_MODALITY ipm ON io.INSURANCE_PRODUCT_ID = ipm.INSURANCE_PRODUCT_ID WHERE io.PRODUCT_OFFER_ID = :PRODUCT_OFFER_ID ORDER BY INSURANCE_CONSIDERATION_TYPE, CNSD_PUBLICATION_ORDER_NUMBER DESC
PISD.SELECT_CONTRACT=conPISD; SELECT INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID FROM PISD.T_PISD_INSURANCE_CONTRACT WHERE POLICY_ID = :POLICY_ID
PISD.UPDATE_INSURANCE_SIMULATION_CUSTOMER=conPISD; UPDATE PISD.T_PISD_INSURANCE_SIMULATION SET CUSTOMER_ID = :CUSTOMER_ID, USER_AUDIT_ID = :USER_AUDIT_ID, AUDIT_DATE = SYSTIMESTAMP WHERE INSURANCE_SIMULATION_ID = :INSURANCE_SIMULATION_ID
PISD.UPDATE_INSURANCE_QUOTATION_CUSTOMER=conPISD; UPDATE PISD.T_PISD_INSURANCE_QUOTATION SET CUSTOMER_ID = :CUSTOMER_ID, USER_AUDIT_ID = :USER_AUDIT_ID, AUDIT_DATE = SYSTIMESTAMP WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID

PISD.UPDATE_EXTERNAL_POLICY_IN_CONTRACT_TABLE=conPISD; UPDATE PISD.T_PISD_INSURANCE_CONTRACT SET POLICY_ID = :POLICY_ID WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID 
PISD.SELECT_REQUIRED_FIELDS_FOR_CREATEDINSRC_EVENT=conPISD; SELECT c.INSURANCE_CONTRACT_ENTITY_ID || c.INSURANCE_CONTRACT_BRANCH_ID || c.CONTRACT_FIRST_VERFN_DIGIT_ID || c.CONTRACT_SECOND_VERFN_DIGIT_ID || c.INSRC_CONTRACT_INT_ACCOUNT_ID as CONTRACT_NUMBER, c.POLICY_ID as POLICY_ID, cr.PAYMENT_METHOD_TYPE as PAYMENT_METHOD_TYPE, pp.PAYMENT_FREQUENCY_NAME as PAYMENT_FREQUENCY_NAME, ic.INSURANCE_COMPANY_DESC as INSURANCE_COMPANY_DESC, p.INSURANCE_PRODUCT_DESC as INSURANCE_PRODUCT_DESC, pmod.INSURANCE_MODALITY_NAME as INSURANCE_MODALITY_NAME, s.INSRNC_COMPANY_SIMULATION_ID as INSRNC_COMPANY_SIMULATION_ID FROM PISD.T_PISD_INSURANCE_CONTRACT c INNER JOIN PISD.T_PISD_INSURANCE_QUOTATION q ON c.POLICY_QUOTA_INTERNAL_ID = q.POLICY_QUOTA_INTERNAL_ID INNER JOIN PISD.T_PISD_INSURANCE_SIMULATION s ON q.INSURANCE_SIMULATION_ID = s.INSURANCE_SIMULATION_ID INNER JOIN PISD.T_PISD_INSURANCE_PRODUCT p ON c.INSURANCE_PRODUCT_ID = p.INSURANCE_PRODUCT_ID INNER JOIN PISD.T_PISD_INSRNC_PRD_MODALITY pmod ON c.INSURANCE_PRODUCT_ID = pmod.INSURANCE_PRODUCT_ID AND c.INSURANCE_MODALITY_TYPE = pmod.INSURANCE_MODALITY_TYPE INNER JOIN PISD.T_PISD_INSURANCE_CTR_RECEIPTS cr ON c.INSURANCE_CONTRACT_BRANCH_ID = cr.INSURANCE_CONTRACT_BRANCH_ID AND c.INSRC_CONTRACT_INT_ACCOUNT_ID = cr.INSRC_CONTRACT_INT_ACCOUNT_ID INNER JOIN PISD.T_PISD_INSRNC_PAYMENT_PERIOD pp ON c.PAYMENT_FREQUENCY_ID = pp.PAYMENT_FREQUENCY_ID INNER JOIN PISD.T_PISD_INSURANCE_COMPANY ic ON c.INSURANCE_COMPANY_ID = ic.INSURANCE_COMPANY_ID WHERE c.POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID AND cr.POLICY_RECEIPT_ID = 1;

PISD.GET_PRODUCT_MODALITIES_INFORMATION_WITH_FLEXIBLE=conPISD; SELECT  pm.INSURANCE_COMPANY_MODALITY_ID,  pm.INSURANCE_MODALITY_NAME,  pm.INSURANCE_MODALITY_TYPE,  pm.SUGGESTED_MODALITY_IND_TYPE,  ms.PUBLICATION_ORDER_NUMBER,  pm.FLEXIBLE_COVRG_PLAN_IND_TYPE , pm.NEW_MODALITY_IND_TYPE FROM PISD.T_PISD_INSRNC_PRD_MODALITY  pm LEFT JOIN PISD.T_PISD_INSURANCE_MOD_SCHAN ms ON pm.INSURANCE_PRODUCT_ID = ms.INSURANCE_PRODUCT_ID  AND pm.INSURANCE_MODALITY_TYPE = ms.INSURANCE_MODALITY_TYPE WHERE pm.INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND pm.INSURANCE_MODALITY_TYPE IN (:INSURANCE_MODALITY_TYPE) AND ms.SALE_CHANNEL_ID = :SALE_CHANNEL_ID  ORDER BY ms.PUBLICATION_ORDER_NUMBER
PISD.GET_PRODUCT_MODALITIES_INFORMATION_UNEMPLOYMENT=conPISD; SELECT  pm.INSURANCE_COMPANY_MODALITY_ID,  pm.INSURANCE_MODALITY_NAME,  pm.INSURANCE_MODALITY_TYPE,  pm.SUGGESTED_MODALITY_IND_TYPE,  ms.PUBLICATION_ORDER_NUMBER, pm.OPERATION_GLOSSARY_DESC FROM PISD.T_PISD_INSRNC_PRD_MODALITY  pm LEFT JOIN PISD.T_PISD_INSURANCE_MOD_SCHAN ms ON pm.INSURANCE_PRODUCT_ID = ms.INSURANCE_PRODUCT_ID AND pm.INSURANCE_MODALITY_TYPE = ms.INSURANCE_MODALITY_TYPE LEFT JOIN PISD.T_PISD_INSURANCE_CATALOG c ON c.KEY_CATALOG_ID = '0034' AND c.CATALOG_ELEMENT_ID = pm.INSURANCE_MODALITY_TYPE AND c.REGISTRY_SITUATION_TYPE = '01' WHERE pm.INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND c.CATALOG_ELEMENT_DESC IN (:INSURANCE_MODALITY_TYPE) AND ms.SALE_CHANNEL_ID = :SALE_CHANNEL_ID ORDER BY ms.PUBLICATION_ORDER_NUMBER

PISD.SELECT_LEGAL_PARTICIPANT=conPISD; SELECT PERSONAL_DOC_TYPE, PARTICIPANT_PERSONAL_ID FROM PISD.T_PISD_INSRNC_CTR_PARTICIPANT WHERE INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID AND PARTICIPANT_ROLE_ID = 3

PISD.SELECT_PRODUCT_BY_COMPANY_SIMULATION_ID=conPISD; SELECT SIM.INSRNC_COMPANY_SIMULATION_ID, PRD.INSURANCE_PRODUCT_ID, PRD.PRODUCT_SHORT_DESC, PRD.INSURANCE_PRODUCT_TYPE, BSN.INSURANCE_BUSINESS_NAME FROM PISD.T_PISD_INSURANCE_SIMULATION SIM LEFT JOIN PISD.T_PISD_INSRNC_SIMLT_PRD SPR ON SIM.INSURANCE_SIMULATION_ID = SPR.INSURANCE_SIMULATION_ID LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT PRD ON SPR.INSURANCE_PRODUCT_ID = PRD.INSURANCE_PRODUCT_ID LEFT JOIN PISD.T_PISD_INSURANCE_BUSINESS BSN ON BSN.INSURANCE_RISK_BUSINESS_ID = PRD.INSURANCE_RISK_BUSINESS_ID WHERE SIM.INSRNC_COMPANY_SIMULATION_ID = :INSRNC_COMPANY_SIMULATION_ID 

PISD.UPDATE_ONLY_RECEIPT_ID=conPISD; UPDATE PISD.T_PISD_INSURANCE_CTR_RECEIPTS SET INSURANCE_COMPANY_RECEIPT_ID = :INSURANCE_COMPANY_RECEIPT_ID WHERE INSURANCE_CONTRACT_ENTITY_ID = :INSURANCE_CONTRACT_ENTITY_ID AND INSURANCE_CONTRACT_BRANCH_ID = :INSURANCE_CONTRACT_BRANCH_ID AND INSRC_CONTRACT_INT_ACCOUNT_ID = :INSRC_CONTRACT_INT_ACCOUNT_ID

PISD.INSERT_INSURANCE_CONTRACT_DETAILS=conPISD; INSERT INTO PISD.T_PISD_CTR_LINKED_INSRNC_CTR (INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID, LINKED_CONTRACT_ID, PRODUCT_ID, START_LINKAGE_DATE, LINKAGE_END_DATE, CONTRACT_LINKED_STATUS_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_CONTRACT_ENTITY_ID, :INSURANCE_CONTRACT_BRANCH_ID, :INSRC_CONTRACT_INT_ACCOUNT_ID, :LINKED_CONTRACT_ID, :PRODUCT_ID, :START_LINKAGE_DATE, :LINKAGE_END_DATE, :CONTRACT_LINKED_STATUS_TYPE, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)