PISD.SELECT_INSURANCE_PRODUCT=conPISD;SELECT INSURANCE_RISK_BUSINESS_ID, INSURANCE_PRODUCT_ID, INSURANCE_PRODUCT_DESC FROM PISD.T_PISD_INSURANCE_PRODUCT WHERE INSURANCE_PRODUCT_TYPE = :INSURANCE_PRODUCT_TYPE
PISD.SELECT_INSURANCE_BUSINESS=conPISD;SELECT INSURANCE_BUSINESS_NAME FROM PISD.T_PISD_INSURANCE_BUSINESS WHERE INSURANCE_RISK_BUSINESS_ID = :INSURANCE_RISK_BUSINESS_ID
PISD.SELECT_INSRNC_PRD_MODALITY=conPISD;SELECT INSURANCE_COMPANY_MODALITY_ID, INSURANCE_MODALITY_NAME, INSURANCE_MODALITY_TYPE, SUGGESTED_MODALITY_IND_TYPE FROM PISD.T_PISD_INSRNC_PRD_MODALITY WHERE INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND INSURANCE_MODALITY_TYPE IN (:INSURANCE_MODALITY_TYPE)
PISD.SELECT_INSRNC_PRD_MODALITY_BY_COMPANY_MODALITY_ID=conPISD;SELECT INSURANCE_COMPANY_MODALITY_ID, INSURANCE_MODALITY_NAME, INSURANCE_MODALITY_TYPE, SUGGESTED_MODALITY_IND_TYPE FROM PISD.T_PISD_INSRNC_PRD_MODALITY WHERE INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND INSURANCE_COMPANY_MODALITY_ID IN (:INSURANCE_COMPANY_MODALITY_ID)
PISD.SELECT_CONSIDERATIONS=conPISD;SELECT mc.INSURANCE_MODALITY_TYPE, mc.CNSD_PUBLICATION_ORDER_NUMBER, c.INSURANCE_CONSIDERATION_DESC, c.INSURANCE_CONSIDERATION_TYPE, c.INSRC_CNSD_DATA_VALUE_TYPE, c.INSURANCE_CONSIDERATION_AMOUNT, c.CURRENCY_ID, c.INSURANCE_CONSIDERATION_PER FROM PISD.T_PISD_MODALITY_INSRNC_CNSD mc, PISD.T_PISD_INSRNC_CONSIDERATION c WHERE mc.INSURANCE_PRODUCT_ID = :INSURANCE_PRODUCT_ID AND mc.INSURANCE_MODALITY_TYPE IN (:INSURANCE_MODALITY_TYPE) AND mc.INSURANCE_CONSIDERATION_ID = c.INSURANCE_CONSIDERATION_ID AND mc.REGISTRY_SITUATION_TYPE = '01' AND c.REGISTRY_SITUATION_TYPE = '01' AND mc.CONSIDERATION_START_DATE <= sysdate AND mc.CONSIDERATION_END_DATE >= sysdate
PISD.SELECT_INSURANCE_SIMULATION_ID=conPISD;SELECT PISD.Q_PISD_SIMULATION_ID0.NEXTVAL FROM DUAL
PISD.INSERT_INSURANCE_SIMULATION=conPISD;INSERT INTO PISD.T_PISD_INSURANCE_SIMULATION (INSURANCE_SIMULATION_ID, INSRNC_COMPANY_SIMULATION_ID, CUSTOMER_ID, CUSTOMER_SIMULATION_DATE, CUST_SIMULATION_EXPIRED_DATE, BANK_FACTOR_TYPE, BANK_FACTOR_AMOUNT, BANK_FACTOR_PER, REGISTRY_SITUATION_TYPE, SOURCE_BRANCH_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_SIMULATION_ID, :INSRNC_COMPANY_SIMULATION_ID, :CUSTOMER_ID, TO_DATE(:CUSTOMER_SIMULATION_DATE, 'DD/MM/YYYY'), TO_DATE(:CUST_SIMULATION_EXPIRED_DATE, 'DD/MM/YYYY'), :BANK_FACTOR_TYPE, :BANK_FACTOR_AMOUNT, :BANK_FACTOR_PER, '01', :SOURCE_BRANCH_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_INSRNC_SIMLT_PRD=conPISD;INSERT INTO PISD.T_PISD_INSRNC_SIMLT_PRD (INSURANCE_SIMULATION_ID, INSURANCE_PRODUCT_ID, CAMPAIGN_FACTOR_TYPE, CAMPAIGN_OFFER_1_AMOUNT, CAMPAIGN_FACTOR_PER, SALE_CHANNEL_ID, REGISTRY_SITUATION_TYPE, SOURCE_BRANCH_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_SIMULATION_ID, :INSURANCE_PRODUCT_ID, :CAMPAIGN_FACTOR_TYPE, :CAMPAIGN_OFFER_1_AMOUNT, :CAMPAIGN_FACTOR_PER, :SALE_CHANNEL_ID, '01', :SOURCE_BRANCH_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_INSRNC_SIMLT_VEHICLE=conPISD;INSERT INTO PISD.T_PISD_INSRNC_SIMLT_VEHICLE (INSURANCE_SIMULATION_ID, INSURANCE_PRODUCT_ID, VEHICLE_BRAND_ID, VEHICLE_BRAND_NAME, VEHICLE_MODEL_ID, VEHICLE_MODEL_NAME, VEHICLE_YEAR_ID, COMMERCIAL_VEHICLE_AMOUNT, CURRENCY_ID, NEW_VEHICLE_IND_TYPE, VEHICLE_CIRCULATION_SCOPE_TYPE, VEH_CHANGE_RUDDER_IND_TYPE, VEHICLE_GAS_CONVERSION_TYPE, VEHICLE_USE_TYPE, VEHICLE_USAGE_DESC, VEHICLE_LICENSE_ID, REGISTRY_SITUATION_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_SIMULATION_ID, :INSURANCE_PRODUCT_ID, :VEHICLE_BRAND_ID, :VEHICLE_BRAND_NAME, :VEHICLE_MODEL_ID, :VEHICLE_MODEL_NAME, :VEHICLE_YEAR_ID, :COMMERCIAL_VEHICLE_AMOUNT, :CURRENCY_ID, :NEW_VEHICLE_IND_TYPE, :VEHICLE_CIRCULATION_SCOPE_TYPE, :VEH_CHANGE_RUDDER_IND_TYPE, :VEHICLE_GAS_CONVERSION_TYPE, :VEHICLE_USE_TYPE, :VEHICLE_USAGE_DESC, :VEHICLE_LICENSE_ID, '01', :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.SELECT_INSURANCE_QUOTATION=conPISD;SELECT p.INSURANCE_PRODUCT_TYPE AS INSURANCE_PRODUCT_TYPE, p.INSURANCE_PRODUCT_DESC AS INSURANCE_PRODUCT_DESC, q.QUOTA_HMS_DATE AS QUOTA_HMS_DATE, qmod.INSURANCE_MODALITY_TYPE AS INSURANCE_MODALITY_TYPE, qmod.POLICY_PAYMENT_FREQUENCY_TYPE AS POLICY_PAYMENT_FREQUENCY_TYPE, qmod.POLICY_QUOTA_STATUS_TYPE AS POLICY_QUOTA_STATUS_TYPE, pmod.INSURANCE_MODALITY_NAME AS INSURANCE_MODALITY_NAME, pmod.SUGGESTED_MODALITY_IND_TYPE AS SUGGESTED_MODALITY_IND_TYPE, pp.PAYMENT_FREQUENCY_NAME AS PAYMENT_FREQUENCY_NAME, qmod.PREMIUM_AMOUNT AS PREMIUM_AMOUNT, qmod.PREMIUM_CURRENCY_ID AS PREMIUM_CURRENCY_ID, v.VEHICLE_MODEL_ID as VEHICLE_MODEL_ID, v.VEHICLE_BRAND_ID as VEHICLE_BRAND_ID FROM PISD.T_PISD_INSRNC_QUOTATION_MOD qmod LEFT JOIN PISD.T_PISD_INSURANCE_QUOTATION q ON qmod.POLICY_QUOTA_INTERNAL_ID = q.POLICY_QUOTA_INTERNAL_ID LEFT JOIN PISD.T_PISD_INSRNC_PRD_MODALITY pmod ON qmod.INSURANCE_PRODUCT_ID = pmod.INSURANCE_PRODUCT_ID AND qmod.INSURANCE_MODALITY_TYPE = pmod.INSURANCE_MODALITY_TYPE LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT p ON qmod.INSURANCE_PRODUCT_ID = p.INSURANCE_PRODUCT_ID LEFT JOIN PISD.T_PISD_INSRNC_PAYMENT_PERIOD pp ON qmod.POLICY_PAYMENT_FREQUENCY_TYPE = pp.POLICY_PAYMENT_FREQUENCY_TYPE LEFT JOIN PISD.T_PISD_INSRNC_SIMLT_VEHICLE v ON q.INSURANCE_SIMULATION_ID = v.INSURANCE_SIMULATION_ID WHERE qmod.POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.SELECT_INSURANCE_SIMULATION_BY_QUOTATIONID=conPISD;SELECT INSURANCE_SIMULATION_ID, CUST_SIMULATION_EXPIRED_DATE FROM PISD.T_PISD_INSURANCE_SIMULATION WHERE INSRNC_COMPANY_SIMULATION_ID = :INSRNC_COMPANY_SIMULATION_ID
PISD.INSERT_INSURANCE_QUOTATION=conPISD;INSERT INTO PISD.T_PISD_INSURANCE_QUOTATION (POLICY_QUOTA_INTERNAL_ID, INSURANCE_SIMULATION_ID, INSURANCE_COMPANY_QUOTA_ID, QUOTE_DATE, QUOTA_HMS_DATE, POLICY_QUOTA_END_VALIDITY_DATE, CUSTOMER_ID, POLICY_QUOTA_STATUS_TYPE, LAST_CHANGE_BRANCH_ID, SOURCE_BRANCH_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:POLICY_QUOTA_INTERNAL_ID, :INSURANCE_SIMULATION_ID, :INSURANCE_COMPANY_QUOTA_ID, TO_DATE(:QUOTE_DATE, 'DD/MM/YYYY'), SYSTIMESTAMP, :POLICY_QUOTA_END_VALIDITY_DATE, :CUSTOMER_ID, 'COT', :LAST_CHANGE_BRANCH_ID, :SOURCE_BRANCH_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_INSURANCE_QUOTATION_MOD=conPISD;INSERT INTO PISD.T_PISD_INSRNC_QUOTATION_MOD (POLICY_QUOTA_INTERNAL_ID, INSURANCE_PRODUCT_ID, INSURANCE_MODALITY_TYPE, SALE_CHANNEL_ID, PAYMENT_TERM_NUMBER, POLICY_PAYMENT_FREQUENCY_TYPE, FINANCING_START_DATE, FINANCING_END_DATE, PREMIUM_AMOUNT, PREMIUM_CURRENCY_ID, SAVED_QUOTATION_IND_TYPE, LAST_CHANGE_BRANCH_ID, SOURCE_BRANCH_ID, POLICY_QUOTA_STATUS_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:POLICY_QUOTA_INTERNAL_ID, :INSURANCE_PRODUCT_ID, :INSURANCE_MODALITY_TYPE, :SALE_CHANNEL_ID, :PAYMENT_TERM_NUMBER, :POLICY_PAYMENT_FREQUENCY_TYPE, TO_DATE(:FINANCING_START_DATE, 'DD/MM/YYYY'), TO_DATE(:FINANCING_END_DATE, 'DD/MM/YYYY'), :PREMIUM_AMOUNT, :PREMIUM_CURRENCY_ID, :SAVED_QUOTATION_IND_TYPE, :LAST_CHANGE_BRANCH_ID, :SOURCE_BRANCH_ID, 'COT', :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.INSERT_INSURANCE_QUOTATION_VEH=conPISD;INSERT INTO PISD.T_PISD_INSRNC_QUOTATION_VEH (POLICY_QUOTA_INTERNAL_ID, INSURANCE_PRODUCT_ID, INSURANCE_MODALITY_TYPE, REQUIRED_INSPECTION_IND_TYPE, GPS_IND_TYPE, CHASSIS_ID, VEHICLE_ENGINE_ID, VEHICLE_SEAT_NUMBER, POLICY_QUOTA_STATUS_TYPE, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:POLICY_QUOTA_INTERNAL_ID, :INSURANCE_PRODUCT_ID, :INSURANCE_MODALITY_TYPE, :REQUIRED_INSPECTION_IND_TYPE, :GPS_IND_TYPE, :CHASSIS_ID, :VEHICLE_ENGINE_ID, :VEHICLE_SEAT_NUMBER, 'COT', :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.SELECT_INSURANCE_COMPANY=conPISD;SELECT INSURANCE_COMPANY_DESC FROM PISD.T_PISD_INSURANCE_COMPANY WHERE INSURANCE_COMPANY_ID = :INSURANCE_COMPANY_ID
PISD.UPDATE_INSURANCE_QUOTATION_VEH=conPISD;UPDATE PISD.T_PISD_INSRNC_QUOTATION_VEH SET CHASSIS_ID = :CHASSIS_ID, VEHICLE_ENGINE_ID = :VEHICLE_ENGINE_ID , VEHICLE_SEAT_NUMBER = :VEHICLE_SEAT_NUMBER WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.SELECT_INSURANCE_QUOTATION_REGISTER=conPISD;SELECT INSURANCE_COMPANY_QUOTA_ID FROM PISD.T_PISD_INSURANCE_QUOTATION WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.QUERY_FOR_GET_QUOTATION_SERVICE=conPISD;SELECT q.INSURANCE_COMPANY_QUOTA_ID AS INSURANCE_COMPANY_QUOTA_ID, q.CUSTOMER_ID AS CUSTOMER_ID, qv.INSURANCE_PRODUCT_ID AS INSURANCE_PRODUCT_ID, qv.REQUIRED_INSPECTION_IND_TYPE AS REQUIRED_INSPECTION_IND_TYPE, qv.GPS_IND_TYPE AS GPS_IND_TYPE, sv.VEHICLE_BRAND_ID AS VEHICLE_BRAND_ID, sv.VEHICLE_BRAND_NAME AS VEHICLE_BRAND_NAME, sv.VEHICLE_MODEL_ID AS VEHICLE_MODEL_ID, sv.VEHICLE_MODEL_NAME AS VEHICLE_MODEL_NAME, sv.VEHICLE_YEAR_ID AS VEHICLE_YEAR_ID, sv.COMMERCIAL_VEHICLE_AMOUNT AS COMMERCIAL_VEHICLE_AMOUNT, sv.CURRENCY_ID AS CURRENCY_ID, sv.VEHICLE_CIRCULATION_SCOPE_TYPE AS VEHICLE_CIRCULATION_SCOPE_TYPE, sv.VEHICLE_GAS_CONVERSION_TYPE AS VEHICLE_GAS_CONVERSION_TYPE, sv.VEHICLE_LICENSE_ID AS VEHICLE_LICENSE_ID, p.INSURANCE_PRODUCT_TYPE AS INSURANCE_PRODUCT_TYPE, p.INSURANCE_PRODUCT_DESC AS INSURANCE_PRODUCT_DESC FROM PISD.T_PISD_INSURANCE_QUOTATION q LEFT JOIN PISD.T_PISD_INSRNC_QUOTATION_VEH qv ON q.POLICY_QUOTA_INTERNAL_ID = qv.POLICY_QUOTA_INTERNAL_ID LEFT JOIN PISD.T_PISD_INSRNC_SIMLT_VEHICLE sv ON q.INSURANCE_SIMULATION_ID = sv.INSURANCE_SIMULATION_ID LEFT JOIN PISD.T_PISD_INSURANCE_PRODUCT p ON sv.INSURANCE_PRODUCT_ID = p.INSURANCE_PRODUCT_ID WHERE q.POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.UPDATE_INSURANCE_QUOTATION=conPISD; UPDATE PISD.T_PISD_INSURANCE_QUOTATION  SET LAST_CHANGE_BRANCH_ID = :LAST_CHANGE_BRANCH_ID WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.UPDATE_INSRNC_QUOTATION_MOD=conPISD; UPDATE PISD.T_PISD_INSRNC_QUOTATION_MOD  SET LAST_CHANGE_BRANCH_ID = :LAST_CHANGE_BRANCH_ID WHERE POLICY_QUOTA_INTERNAL_ID = :POLICY_QUOTA_INTERNAL_ID
PISD.INSERT_CONTRACT=conPISD; INSERT INTO PISD.T_PISD_INSURANCE_CONTRACT (INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID, CONTRACT_FIRST_VERFN_DIGIT_ID, CONTRACT_SECOND_VERFN_DIGIT_ID, POLICY_QUOTA_INTERNAL_ID, INSURANCE_PRODUCT_ID, INSURANCE_MODALITY_TYPE, INSURANCE_COMPANY_ID, POLICY_ID, INSURANCE_MANAGER_ID, INSURANCE_PROMOTER_ID, CONTRACT_MANAGER_BRANCH_ID, CONTRACT_INCEPTION_DATE, INSURANCE_CONTRACT_START_DATE, INSURANCE_CONTRACT_END_DATE, INSRNC_VALIDITY_MONTHS_NUMBER, INSURANCE_POLICY_END_DATE, POLICY_ANNULATION_DATE, AFTR_REPRG_PENDING_INST_NUMBER, CONTRACT_REGIS_CST_AGE_NUMBER, CUSTOMER_ID, DOMICILE_CONTRACT_ID, CARD_ISSUING_MARK_TYPE, ISSUED_RECEIPT_NUMBER, PAYMENT_FREQUENCY_ID, PREMIUM_AMOUNT, NET_PREM_PLCY_ORIG_CURR_AMOUNT, SETTLE_PENDING_PREMIUM_AMOUNT, POLICY_FEE_AMOUNT, CURRENCY_ID, LAST_INSTALLMENT_DATE, INSTALLMENT_PERIOD_FINAL_DATE, INSURED_AMOUNT, BENEFICIARY_TYPE, RENEWAL_NUMBER, NEXT_RENEWAL_START_DATE, POLICY_PYMT_PEND_DUE_DEBT_TYPE, CTRCT_DISPUTE_STATUS_TYPE, CONTRACT_PREVIOUS_BRANCH_ID, PERIOD_NEXT_PAYMENT_DATE, CONT_PREVIOUS_SITUATION_TYPE, ENDORSEMENT_POLICY_IND_TYPE, INSRNC_CO_CONTRACT_STATUS_TYPE, CONTRACT_STATUS_ID, CREATION_USER_ID, CREATION_DATE, USER_AUDIT_ID, AUDIT_DATE) VALUES (:INSURANCE_CONTRACT_ENTITY_ID, :INSURANCE_CONTRACT_BRANCH_ID, :INSRC_CONTRACT_INT_ACCOUNT_ID, :CONTRACT_FIRST_VERFN_DIGIT_ID, :CONTRACT_SECOND_VERFN_DIGIT_ID, :POLICY_QUOTA_INTERNAL_ID, :INSURANCE_PRODUCT_ID, :INSURANCE_MODALITY_TYPE, :INSURANCE_COMPANY_ID, :POLICY_ID, :INSURANCE_MANAGER_ID, :INSURANCE_PROMOTER_ID, :CONTRACT_MANAGER_BRANCH_ID, TO_DATE(:CONTRACT_INCEPTION_DATE, 'DD/MM/YYYY'), TO_DATE(:INSURANCE_CONTRACT_START_DATE, 'DD/MM/YYYY'), TO_DATE(:INSURANCE_CONTRACT_END_DATE, 'DD/MM/YYYY'), :INSRNC_VALIDITY_MONTHS_NUMBER, TO_DATE(:INSURANCE_POLICY_END_DATE, 'DD/MM/YYYY'), TO_DATE(:POLICY_ANNULATION_DATE, 'DD/MM/YYYY'), :AFTR_REPRG_PENDING_INST_NUMBER, :CONTRACT_REGIS_CST_AGE_NUMBER, :CUSTOMER_ID, :DOMICILE_CONTRACT_ID, :CARD_ISSUING_MARK_TYPE, :ISSUED_RECEIPT_NUMBER, :PAYMENT_FREQUENCY_ID, :PREMIUM_AMOUNT, :NET_PREM_PLCY_ORIG_CURR_AMOUNT, :SETTLE_PENDING_PREMIUM_AMOUNT, :POLICY_FEE_AMOUNT, :CURRENCY_ID, TO_DATE(:LAST_INSTALLMENT_DATE, 'DD/MM/YYYY'), TO_DATE(:INSTALLMENT_PERIOD_FINAL_DATE, 'DD/MM/YYYY'), :INSURED_AMOUNT, :BENEFICIARY_TYPE, :RENEWAL_NUMBER, TO_DATE(:NEXT_RENEWAL_START_DATE, 'DD/MM/YYYY'), :POLICY_PYMT_PEND_DUE_DEBT_TYPE, :CTRCT_DISPUTE_STATUS_TYPE, :CONTRACT_PREVIOUS_BRANCH_ID, TO_DATE(:PERIOD_NEXT_PAYMENT_DATE, 'DD/MM/YYYY'), :CONT_PREVIOUS_SITUATION_TYPE, :ENDORSEMENT_POLICY_IND_TYPE, :INSRNC_CO_CONTRACT_STATUS_TYPE, :CONTRACT_STATUS_ID, :CREATION_USER_ID, SYSTIMESTAMP, :USER_AUDIT_ID, SYSTIMESTAMP)
PISD.SELECT_INSURANCE_CONTRACT=conPISD; SELECT INSURANCE_CONTRACT_ENTITY_ID, INSURANCE_CONTRACT_BRANCH_ID, INSRC_CONTRACT_INT_ACCOUNT_ID FROM PISD.T_PISD_INSURANCE_CONTRACT WHERE POLICY_ID = :POLICY_ID